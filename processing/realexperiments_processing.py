from matplotlib import pylab as plt
import scipy.io as sio
import math
import numpy as np
from numpy import argmin

data = sio.loadmat('/home/dav/Dropbox/notebook/BoundaryMultipleRobots/real_experiments/experiment1.mat', squeeze_me=True)

# Maximum time
tmax = argmin(data['boat_loc_save'][:, 0])
# tmax = 3000
# Robot trajectories
traj_robot1 = data['boat_loc_save'][:tmax]
traj_robot2 = data['boat2_loc_save'][:tmax]
traj_robot3 = data['boat3_loc_save'][:tmax]

trajectories = [traj_robot1, traj_robot3, traj_robot2]
n = len(trajectories)

# Boundaries
data_boundaries = data['boundaries']

boundaries = []
for dboundary in data_boundaries:
    dboundary = np.array(dboundary, np.float32)
    dboundary[:, 0] -= 30.
    dboundary[:, 1] -= 30.
    #     dboundary += 120.

    dboundary[:, 0] *= .9
    dboundary[:, 1] *= .8
    dboundary /= 100.
    boundaries.append(dboundary)

b = boundaries[100]
plt.plot(b[:, 0], b[:, 1])

############## Processing data
import sys

sys.path.append("/home/dav/Dropbox/pylib/boundary-estimation")

from enclosing.cooperative_enclosing import boundaries_on_time, init_agents, move_agents, draw_initial_path, \
    polylines_to_pieceswise_boundary, draw_arc_param, update_pieceswise_boundary, update_s_locations
from enclosing.s_estimator import parametrize_polyset
from enclosing.Agent import Agent

## Create agents with data
initial_data = 250

trajectories = [traj_robot3, traj_robot1, traj_robot2]

agents = []
for traj in trajectories:
    print traj[initial_data - 1]
    agent = Agent(traj[initial_data - 1], -math.pi / 2)
    agent.traj_x = traj[:initial_data, 0].tolist()
    agent.traj_y = traj[:initial_data, 1].tolist()
    agents.append(agent)

# for agent in agents:
#     plot(agent.traj_x, agent.traj_y)
# draw_initial_path(agents, boundaries, draw_paths=True)
#
# plt.show()

###### Init piecewise boundary
polyset, idz, zero_point, zero_line = polylines_to_pieceswise_boundary(agents, draw_perps=False,
                                                                       draw_init_polyset=False)

# Location of the agent in the curve.
ss = parametrize_polyset(polyset, idz)
update_s_locations(agents, ss, polyset)


# bx, by = boundaries[initial_steps].T
# plt.plot(bx, by, '--')
# plt.plot([100,300], [100,300], '.')
# plt.savefig('1b-piecewise.pdf',bbox_inches='tight', pad_inches = 0)




################ Moving
# Continue predicting
def move_along_boundary(agents, initial_steps, boundaries, zeropath, running_steps=140,
                        p_gain=.4, robot_speed=.2):
    (id_zero, zero_point, zero_line, polyset) = zeropath
    N = len(agents)
    errors = []
    polysets = []

    # Move the boundary
    for k in range(running_steps):
        #         print float(k)/running_steps,
        # boundary = boundaries[initial_steps + k]
        print k
        # For each agent
        single_error = []
        for i in range(N):
            a = agents[i]

            nx, ny = trajectories[i][initial_steps + k]
            a.x = nx
            a.y = ny
            a.traj_x.append(nx)
            a.traj_y.append(ny)

            #             vel, e = vel_control(i, agents, ke=p_gain, robot_speed=robot_speed)
            #             a.move_on_boundary(boundary, vel)

            #             single_error.append(e)
            ### Update piecewise boundary
            polyset, id_zero, zero_point, zero_line = update_pieceswise_boundary(i, a, id_zero, zero_point, zero_line,
                                                                                 polyset,
                                                                                 draw_polysets=False)
            # Parametrize curve
            ss = parametrize_polyset(polyset, id_zero)

            # if k == 148 or k == 149:
            if True:
                print polyset, id_zero
                ##### Update location of the agents in the curve
                #             update_s_locations(agents, ss, polyset)
                for poly in polyset:
                    plt.plot(poly[0], poly[1], '.-')
                plt.show()

        N = len(agents)
        for i in range(N):
            a = agents[i]
            ns = ss[(i, len(polyset[i][0]) - 1)]  # Normalized e

            #             print "%.2f %.2f"%(a.s, ns,),

            #             if i==0:
            #                 print ss
            # a.s = ns
            if a.s is None:
                a.s = ns
            else:
                # Difference in the circular
                ds = ns - a.s
                ds = math.atan2(math.sin(ds * 2 * math.pi), math.cos(ds * 2 * math.pi)) / (2 * math.pi)
                #             print ds
                # Move the current one
                a.s += ds
                ##### End Update location

            a.traj_s.append(a.s)
            a.traj_t.append(k)
        # print ""


        polysets.append([np.copy(p) for p in polyset])
        errors.append(single_error)
    # print polysets[0][0][1]
    return errors, polysets


# Remove the two initial steps
for a in agents:
    a.traj_x = a.traj_x[4:]
    a.traj_y = a.traj_y[4:]

errors, polysets = move_along_boundary(agents, initial_data, boundaries, (idz, zero_point, zero_line, polyset),
                                       running_steps=len(trajectories[0]) - initial_data)





# from enclosing.s_estimator import parametrize_polyset
#
# polyset, id_zero = [[[2.2725529669323428, 2.2719562108214451, 2.2687382004442451, 2.2643355066142146, 2.2592117766711932, 2.2537796656774454, 2.2482145025048457, 2.2427744346950371, 2.2380371334941325, 2.2346109937264984, 2.2302405263091316, 2.2278222575031874, 2.2250201463389643, 2.2231816611045625, 2.2215665029468852, 2.2197755293422925, 2.218523619053161, 2.2169040115766991, 2.2152177041806178, 2.2136668775022659, 2.2103100768275379, 2.2066931458914141, 2.2007626022132687, 2.1940631073465982, 2.1859301965457281, 2.1768759064457894, 2.1668985582827589, 2.1550430952374677, 2.1397450302743577, 2.1226710220783218, 2.102221597428362, 2.0831431560049678, 2.0640406148119927, 2.0472661362303253, 2.0307990239162979, 2.0132450210445469, 1.9955422205547708, 1.9773001164315758, 1.9589559107855397, 1.9417635569172764, 1.9237750629531016, 1.9146976116457362, 1.9052196069866083, 1.893686019315872, 1.8834481949908672, 1.8726707176421675, 1.861241863448625, 1.8500585807190284, 1.8386342957603745, 1.8275220098626028, 1.8146661240621831, 1.8013621408168075, 1.7915019082121935, 1.7814993721437424, 1.7714691589416456, 1.7636997642559031, 1.7559842930428153, 1.7466419046785744, 1.7384291161224823, 1.7303556572892456, 1.722501633539818, 1.7143890701899749, 1.7068092264975492, 1.6987203729271154, 1.6919696049110982, 1.6850810169718127, 1.6778689665578312, 1.6692304525205863, 1.6614556365369013, 1.6535144192113163, 1.6447016718970213, 1.6345809619307374, 1.6251533239296003, 1.6149592104888113, 1.6042930072124491, 1.594220400846508, 1.5848300288022314, 1.5728310804344432, 1.5622254838262515, 1.5511604939374526, 1.5408871416765253, 1.5305240027575311, 1.520339728342653, 1.5101108913617425, 1.5007716318608739, 1.4913854296382394, 1.4822595242415062, 1.4732291228104435, 1.4642738895688598, 1.455645776195637, 1.4450597259165598, 1.4349241868997975, 1.4246804213524076, 1.4150285870983847, 1.4054848719052269, 1.3944005876954604, 1.3840234367002262, 1.373523786895523, 1.3605959785794415, 1.3481181340614934, 1.3372550162651844, 1.3262307849931969, 1.3132209302976237, 1.3014840390549027, 1.2896130202635971, 1.2776740094415717, 1.2656914868166689, 1.25309664707476, 1.2395468338071647, 1.2259983200308482, 1.2124599193596155, 1.2009133577817304, 1.1881758734865691, 1.1726386211340594, 1.1569933878075591, 1.1412020485825258, 1.1264684574681634, 1.1100078690026147, 1.0964836277323364, 1.0832150344510725, 1.0714013657781449, 1.0603619731463401, 1.050916966675508, 1.0403433685355425, 1.0343370382702424, 1.0260253629721263, 1.0190874745934839, 1.0162550296848161, 1.0111067394132647, 1.0075488617690114, 1.0054947921723159, 1.0025479530661834, 1.0038721800712695, 1.0072135339054396, 1.012331628438381, 1.0212388889049548, 1.0301083685213719, 1.0399495007461543, 1.051263721711498, 1.0657434894654818, 1.0822737269779785, 1.1002639410398871, 1.116582041706069, 1.1330041641718465, 1.148611290497124, 1.1651950222027039, 1.1810307148492252, 1.1972621049574057, 1.2136033775488229], [1.529637748928101, 1.5464036383752817, 1.5632439701053689, 1.5809842214487655, 1.5970476895954193, 1.6140190331587831, 1.6312817698123989, 1.6463983140538561, 1.6612693015959412, 1.6757233290849805, 1.6916678369921727, 1.7086130214768125, 1.725236783734025, 1.742100889449657, 1.7601978514704566, 1.7800205424809707, 1.7992297673259618, 1.8187976105804691, 1.8393963890359435, 1.8587251505318265, 1.878329486933507, 1.8955936182954951, 1.9117536517740432, 1.9259829188190749, 1.9391456282881354, 1.9504675305707173, 1.9603869804613108, 1.9699981039062495, 1.9777475910672107, 1.9849493605340667, 1.9890136492525956, 1.9930671294067479, 1.9980034707441294, 2.0005491889391962, 2.0038339311380948, 2.0065078349679384, 2.010043675641398, 2.0137755588812096, 2.0171606043184815, 2.0201905758540004, 2.0226617373960192, 2.0241920476381621, 2.0256620729458783, 2.0271662378706998, 2.028119378840664, 2.0294983778165063, 2.0313702885021758, 2.0328365389316421, 2.0335542474762636, 2.0339223412205274, 2.0338281083024139, 2.0324602418332569, 2.0304340553980942, 2.0275733047361095, 2.0239418348551803, 2.0199235491671299, 2.0152685362126412, 2.0088770928014772, 2.0021294570640356, 1.9936910368870069, 1.9841171367122279, 1.9752370784075997, 1.9680993981729868, 1.959803981274467, 1.9518677374017197, 1.9442399436226532, 1.9369613940758994, 1.9288935699620018, 1.9216697216520331, 1.9147173997904543, 1.9080176855229489, 1.9009520229852193, 1.8945284078869562, 1.8879327607687511, 1.8814162595814934, 1.8754157836969978, 1.8697257248751515, 1.8623642050430831, 1.8560661918537389, 1.8493663801169866, 1.8431815329729631, 1.8363595233306718, 1.8288592403447141, 1.8217294143919229, 1.8156552235564547, 1.808226760432021, 1.8000653866245704, 1.7926645628958122, 1.785518103737519, 1.7778724835582358, 1.7686219945666855, 1.7604713291218332, 1.7525712694644309, 1.7454860701721964, 1.7388216922063713, 1.7321645578763374, 1.7262124135055117, 1.7203515881826323, 1.7139613785364156, 1.7081340054681273, 1.7026523376258158, 1.6973094838604099, 1.6917084288517539, 1.6866083001150693, 1.6816638237794175, 1.6767656534006092, 1.6718940780970168, 1.6670605328783459, 1.6620853459815543, 1.6575545903646189, 1.6549997689450784, 1.6484004925172226, 1.6416350587352364, 1.6391477882950543, 1.6347781408022317, 1.6316214901802795, 1.6243512579746582, 1.6215605880363446, 1.620971457970291, 1.6171036361998787, 1.6145187361663251, 1.6125134289641361, 1.6091479441588985, 1.6076465428959608, 1.5998983131983264, 1.5981291254606702, 1.5949665039737677, 1.5910621366679163, 1.5890618089405977, 1.5855846033190328, 1.5802822505200949, 1.5721854340571155, 1.5619688448641695, 1.5514972238912232, 1.5405066549177833, 1.5301554463533757, 1.5208982395942598, 1.5151307253455042, 1.5089756334085522, 1.5056357138762138, 1.503007222791938, 1.5000513981099459, 1.4974485029608402, 1.4951794013086506, 1.4923229293907616, 1.4889417199441899, 1.4857207920047739, 1.4818184683783384, 1.4777129114834646]], [[1.5508934113895008, 0.94857302954023204, 0.94994622935422879, 0.95611451412591064, 0.96498826429845874, 0.97643781905557248, 0.99237558910500523, 1.0124991562338874, 1.0324583912878886, 1.0539828000429923, 1.0739835582901174, 1.0914423928295665, 1.107971861300173, 1.1219668833657626, 1.1340431419800892, 1.1473644130538134, 1.1606862179362087, 1.1728189286607325, 1.1850105751350117, 1.2000186869904736, 1.2180905345061128, 1.2406870389492157, 1.2602632131034444, 1.278441197977034, 1.2943549714305664, 1.3096822490539717, 1.32329303992619, 1.3366068912206213, 1.3504731130509051, 1.3670586682124051, 1.3826959730042574, 1.3990993465254422, 1.4152859693408746, 1.432530051604872, 1.4478813323649828, 1.4630741994734504, 1.4782988255772527, 1.492736677586435, 1.5074877220944773, 1.5217253275116696, 1.5356856168362822, 1.5504305793361188, 1.5576167976397479, 1.5649022831012249, 1.5735195242671427, 1.5809479630809065, 1.5882658576716002, 1.5954823939830654, 1.6024066493851876, 1.6091754008235857, 1.6156704653759992, 1.6225679261043202, 1.6349832125190393, 1.6433462035885273, 1.6500644841833061, 1.6599532957074756, 1.6686237581540253, 1.6753313219794186, 1.6818402336092162, 1.6885130325530233, 1.6959109234755587, 1.7028588980026309, 1.7088373862558326, 1.7142538159622778, 1.720920607762858, 1.7267980681532902, 1.7322616349610598, 1.7378016464321762, 1.7444576267879375, 1.7503293860479332, 1.7561053167433274, 1.7621309909383069, 1.7687504234296332, 1.7746197862018327, 1.7809081020681821, 1.7875418720959328, 1.7941693932475811, 1.8004878160645064, 1.8089420229544144, 1.8165754063473067, 1.8247967701065699, 1.8325121660286845, 1.8411564127533466, 1.8504609573478186, 1.8595932540968603, 1.8681323058251174, 1.8776959306769831, 1.8875279811583636, 1.8973513928818009, 1.9073740389219365, 1.9180354664693542, 1.9318275110726446, 1.9446286796291785, 1.9570234299423297, 1.9684726282894001, 1.9796484371783272, 1.9926504651434098, 2.0043014288729806, 2.0150954989136132, 2.027458233081445, 2.0393053689972227, 2.0491210778137789, 2.0581989361373596, 2.0690637392571798, 2.0787390388900686, 2.0879827152198649, 2.0970832342487395, 2.1064158604585241, 2.1158559841462408, 2.1258484792408527, 2.1362095784476365, 2.1473584007726174, 2.1571988425338393, 2.1669707845803421, 2.1783973687140898, 2.1924513563902739, 2.2054111035098569, 2.2156831606356526, 2.229476958864546, 2.2401708979522543, 2.2474564242613697, 2.2556665859495908, 2.2618723660918536, 2.2654801897194892, 2.2700785933423511, 2.2701502364108732, 2.2683838809752612, 2.2718505279702779, 2.2728442492574081, 2.2722649224890938, 2.2742676454758213, 2.2764521942473364, 2.2774458407907576, 2.2799291841760603, 2.2822052673724151, 2.2834259000761081, 2.2858484279507847, 2.2880798472231993, 2.2896243067541846, 2.2916537867360649, 2.2936924282502962, 2.2953287488976857, 2.2974056318165381, 2.2996617213979054, 2.301886328715939, 2.3041583287805221, 2.306902467160227, 2.3091569596506361, 2.3112750577067924, 2.3134546945493009], [1.5596903041199794, 1.5699225094453404, 1.5611201710448257, 1.5470834378811495, 1.5350013649973597, 1.5282083225747125, 1.5194294966341171, 1.5118101362702439, 1.5045358458967624, 1.4952771841181616, 1.4867820707515831, 1.4749675151835147, 1.4645275829952626, 1.4540594943102323, 1.4429821649452759, 1.433544810000807, 1.4242124569892745, 1.4172831110073842, 1.4121981898894858, 1.4067033140224563, 1.4028395652325172, 1.3989651202539555, 1.3956865078367537, 1.391837292738999, 1.3887008309588624, 1.385004496222455, 1.3808833480543985, 1.3770314960361438, 1.3719689217486406, 1.3645692374409235, 1.3560797356885592, 1.3469051815313855, 1.3372494537809578, 1.3265624651361037, 1.3169225588798863, 1.307019828305197, 1.2973841538941313, 1.2881009716830527, 1.2795034824251557, 1.2707693975233521, 1.2625990195737375, 1.2541501066302128, 1.2497513588430562, 1.2452144109949994, 1.23978921446477, 1.235065022626717, 1.2302176253878156, 1.2250442912786825, 1.2197407108104013, 1.214380572961691, 1.2089099857561192, 1.201238747976318, 1.1942156153034151, 1.1835825464653731, 1.1716099076345934, 1.1622946966744783, 1.1556555451938983, 1.1474539740423264, 1.137493227533759, 1.129861187941221, 1.1226729590473559, 1.1144491276949258, 1.1055970590313557, 1.098007258413783, 1.0897527573607735, 1.0820995375038209, 1.0740775293979254, 1.0659988384608208, 1.0562630492771798, 1.0474878113565511, 1.0388897126365242, 1.0303859657931467, 1.021205535840233, 1.0131285956475242, 1.0048897764715328, 0.99666434944778648, 0.9889540318975204, 0.98173327188729764, 0.97276189562039628, 0.96504051449280792, 0.95722309411807904, 0.95027530935073878, 0.94403071640117497, 0.93740283506377065, 0.93103069710749997, 0.92652508103725217, 0.92237729804807189, 0.91832192183427197, 0.91493332958635087, 0.91257056496038225, 0.91106908057421843, 0.90974668451273066, 0.90902793900118406, 0.90872377868002197, 0.90887291015883809, 0.90992057550090655, 0.91071801310164913, 0.91192131033080082, 0.91423719161589867, 0.91765547156480487, 0.9209976525958613, 0.92504777794715454, 0.92998851723175624, 0.93620296793747093, 0.94280102045891934, 0.95062650620839884, 0.9589681160162441, 0.96763641179572257, 0.97695611771233004, 0.98719442235346555, 0.99721986561939047, 1.0059188341886593, 1.0146824369478589, 1.0229623225821169, 1.0319361706048102, 1.0356864790077003, 1.0399481833557536, 1.0481896472000878, 1.0513183003627744, 1.0563215676271551, 1.0630826153771662, 1.0673848940726978, 1.0734687788682202, 1.0820676557469326, 1.0978498442155253, 1.1228006640893149, 1.1463775466767141, 1.1692173730715405, 1.1883303103406746, 1.2064785824008535, 1.2235209962703273, 1.2397471610596815, 1.2560167099369175, 1.2723275846507593, 1.287082060055019, 1.3014259760352971, 1.3164289327122043, 1.3306764760397587, 1.3444071924319239, 1.3577120837430761, 1.3711288482275679, 1.3849708150654763, 1.3997120395465856, 1.4130752331314498, 1.4272328859744063, 1.4412502304548289, 1.4560009771868716, 1.4700137583754813, 1.4847123396547031, 1.4998678352165931]], [[1.5693099867325953, 1.7074283751111301, 1.7208724292817248, 1.733253119745594, 1.7477914041924563, 1.7611757415712981, 1.7755093187499262, 1.790984196001536, 1.8046986872475199, 1.8180837214574628, 1.831177815928595, 1.8461652152654948, 1.8618436253890482, 1.8767971754019654, 1.8919120059794803, 1.9077782124730922, 1.9249038416884374, 1.9410113382499912, 1.9567977303976587, 1.972356573718641, 1.9863544190128293, 2.0035127431090576, 2.0194265219278376, 2.0342969754855194, 2.0479043661188623, 2.0611356358727693, 2.0734516121626836, 2.0863546016605001, 2.1000514494858793, 2.1142102861355099, 2.1261108948759588, 2.1374461210784181, 2.1482068106238312, 2.1595745786903451, 2.1685823179468073, 2.1764288179498648, 2.1831766987884591, 2.1894361526655159, 2.1952197873810926, 2.1998470669401708, 2.2046660004258158, 2.2086716861502764, 2.2097947746598714, 2.2120596033214941, 2.2142493099538556, 2.2163546122260804, 2.2185631768057483, 2.2213588725575519, 2.2242571308978496, 2.2264172746601152, 2.2276714919676253, 2.2287294143035736, 2.2318494486308467, 2.2307743446628692, 2.2306096897411818, 2.2327108472116968, 2.2342117813809219, 2.2335637196926017, 2.23174085374517, 2.2302321154853617, 2.2300605777720941, 2.2301829098411279, 2.2295126758914119, 2.2286615036226625, 2.2287362972546116, 2.2298272164987072, 2.2306378502366542, 2.2316937899999418, 2.2337124736289988, 2.2374370755406998, 2.2412436814172545, 2.2448244921593261, 2.2484661256946126, 2.252938814346686, 2.2572933154911166, 2.2614169109786504, 2.2648609640568313, 2.2675769601483582, 2.2694194558091842, 2.2707247532023929, 2.2711644415798395, 2.2709581635763976, 2.2702292434786027, 2.2689176710732188, 2.2662531521081792, 2.2622554202963667, 2.2582551559639947, 2.2538892592616921, 2.2492646754028285, 2.2442341455057058, 2.2391537677069548, 2.2346144165550808, 2.2296644005497841, 2.2246819061189274, 2.2198958477351995, 2.2151892363637704, 2.210776277480663, 2.2059322728589978, 2.2014185451679129, 2.1966504351607381, 2.1908289596306894, 2.1850271933002476, 2.1796875917933631, 2.1735122672760072, 2.165664648067573, 2.1585101859448619, 2.1500987545006258, 2.1410579982702238, 2.1321037670679415, 2.1227675152324759, 2.1108973669819591, 2.0958459585577396, 2.0798691004935046, 2.0656374116801768, 2.0517738824729546, 2.0383259916129499, 2.0249219678738832, 2.0128477225708794, 2.0012420451844823, 1.9877665332665535, 1.9727843648663601, 1.9541813132854917, 1.9338680840927363, 1.9117980784980446, 1.888656080887223, 1.8666271409425694, 1.8493579790478734, 1.8376863434874395, 1.8267486440441951, 1.8169818814344227, 1.8080077592739769, 1.7993669644107135, 1.7901424402911164, 1.780183527944267, 1.7698510409770645, 1.7600530465363529, 1.7501585722905768, 1.7393280954020562, 1.7289329803018327, 1.7184056605320146, 1.7072373797309071, 1.6950363226420417, 1.6805631478164751, 1.6629741703898588, 1.6456734552592216, 1.6266490754336844, 1.6095487780235025, 1.5936578864230138, 1.5804309837513766, 1.5671954639266192, 1.5547238179211122], [1.577831648930122, 1.0871180737391455, 1.0724939604913404, 1.0593045603760523, 1.0475944451174362, 1.036765628023067, 1.0243490626176568, 1.0128712578106365, 1.0030288604099553, 0.99342692191813675, 0.98418544699152177, 0.97527579286772115, 0.96723127116258611, 0.96060030916319261, 0.95565942268313087, 0.95188503948809799, 0.94969415332934171, 0.94949700953404359, 0.95094677492355162, 0.95421607334010239, 0.95882690072165366, 0.96598121811142224, 0.97628261701148999, 0.98719500154883533, 0.99622369322514481, 1.0054408804817605, 1.0159325309789069, 1.0265942426832222, 1.0390258896921516, 1.0538204578819144, 1.0669982097931738, 1.0809428480256877, 1.0958150155793112, 1.1126751610110972, 1.1278650332181197, 1.1435492814676063, 1.1594294406622487, 1.175034941111313, 1.1917334750881792, 1.2091861766847529, 1.2253232110638628, 1.238253725959118, 1.241879100913855, 1.2502359040609952, 1.2588874753009951, 1.2695458221720923, 1.2794672385654442, 1.2894696652988418, 1.2994692850931076, 1.3094945502245363, 1.3193479781607123, 1.3291145186672877, 1.340540359841043, 1.3554351350843652, 1.3695421486569443, 1.3829196220810307, 1.3966824164655616, 1.4075175853404909, 1.4185154112059679, 1.4311457117420352, 1.442134642762763, 1.4533217556670213, 1.4649401862479052, 1.4764671596408201, 1.4864750578378763, 1.4971884205658152, 1.5070018887882612, 1.5176776698433887, 1.5291293350889399, 1.5427272134128565, 1.5549501559749139, 1.5672449098297487, 1.5801021398443413, 1.59416425746102, 1.6068810009480554, 1.6201113954005109, 1.6334172223480397, 1.6456477500249185, 1.6564785114501237, 1.6698738397547113, 1.6805604019436577, 1.6918441688903396, 1.70212135674497, 1.7138293066807178, 1.7264928692065118, 1.7390763034091106, 1.7504896089481528, 1.763474149042108, 1.7764582908344071, 1.7884452714631371, 1.7994797004263519, 1.8102506914410508, 1.8230487933510566, 1.8343658441029733, 1.8457517769810736, 1.8577325664293858, 1.8711270305992398, 1.8871158109476043, 1.9016649266202466, 1.9150934826031334, 1.9304782448486266, 1.9452023861434931, 1.957931928864052, 1.9699545870331108, 1.9826248383810621, 1.992696358459269, 2.0008205494025293, 2.008015615858378, 2.0140776499585584, 2.0187077266552889, 2.0224755830822891, 2.0246809471385347, 2.0248817660869092, 2.0249182297365884, 2.0256442998980848, 2.0264666029675515, 2.0265286491947885, 2.02720232754805, 2.0281024763208064, 2.0292436258398414, 2.0300938092464511, 2.0322276288053267, 2.0339555503831157, 2.0335471940832242, 2.0303840509798601, 2.0260178121739063, 2.0173184872346299, 2.0081720736574677, 2.0001961152232184, 1.9926059513287164, 1.9831036101281958, 1.9725294595854741, 1.9628199722411854, 1.9534373694394818, 1.9428474176181141, 1.9328237680481213, 1.9233640538860417, 1.9139017894517394, 1.9052324707534909, 1.8969164750282477, 1.888967212325221, 1.8803348021442898, 1.8715490687322298, 1.8616445812915596, 1.8514057539639779, 1.8395119339815806, 1.8291824978538755, 1.8170081451457731, 1.8056581376306091, 1.7952772020770336, 1.7851677893146778]]], [2, 41]
# polyset, id_zero = [[[2.2725529669323428, 2.2719562108214451, 2.2687382004442451, 2.2643355066142146, 2.2592117766711932, 2.2537796656774454, 2.2482145025048457, 2.2427744346950371, 2.2380371334941325, 2.2346109937264984, 2.2302405263091316, 2.2278222575031874, 2.2250201463389643, 2.2231816611045625, 2.2215665029468852, 2.2197755293422925, 2.218523619053161, 2.2169040115766991, 2.2152177041806178, 2.2136668775022659, 2.2103100768275379, 2.2066931458914141, 2.2007626022132687, 2.1940631073465982, 2.1859301965457281, 2.1768759064457894, 2.1668985582827589, 2.1550430952374677, 2.1397450302743577, 2.1226710220783218, 2.102221597428362, 2.0831431560049678, 2.0640406148119927, 2.0472661362303253, 2.0307990239162979, 2.0132450210445469, 1.9955422205547708, 1.9773001164315758, 1.9589559107855397, 1.9417635569172764, 1.9237750629531016, 1.9146976116457362, 1.9052196069866083, 1.893686019315872, 1.8834481949908672, 1.8726707176421675, 1.861241863448625, 1.8500585807190284, 1.8386342957603745, 1.8275220098626028, 1.8146661240621831, 1.8013621408168075, 1.7915019082121935, 1.7814993721437424, 1.7714691589416456, 1.7636997642559031, 1.7559842930428153, 1.7466419046785744, 1.7384291161224823, 1.7303556572892456, 1.722501633539818, 1.7143890701899749, 1.7068092264975492, 1.6987203729271154, 1.6919696049110982, 1.6850810169718127, 1.6778689665578312, 1.6692304525205863, 1.6614556365369013, 1.6535144192113163, 1.6447016718970213, 1.6345809619307374, 1.6251533239296003, 1.6149592104888113, 1.6042930072124491, 1.594220400846508, 1.5848300288022314, 1.5728310804344432, 1.5622254838262515, 1.5511604939374526, 1.5408871416765253, 1.5305240027575311, 1.520339728342653, 1.5101108913617425, 1.5007716318608739, 1.4913854296382394, 1.4822595242415062, 1.4732291228104435, 1.4642738895688598, 1.455645776195637, 1.4450597259165598, 1.4349241868997975, 1.4246804213524076, 1.4150285870983847, 1.4054848719052269, 1.3944005876954604, 1.3840234367002262, 1.373523786895523, 1.3605959785794415, 1.3481181340614934, 1.3372550162651844, 1.3262307849931969, 1.3132209302976237, 1.3014840390549027, 1.2896130202635971, 1.2776740094415717, 1.2656914868166689, 1.25309664707476, 1.2395468338071647, 1.2259983200308482, 1.2124599193596155, 1.2009133577817304, 1.1881758734865691, 1.1726386211340594, 1.1569933878075591, 1.1412020485825258, 1.1264684574681634, 1.1100078690026147, 1.0964836277323364, 1.0832150344510725, 1.0714013657781449, 1.0603619731463401, 1.050916966675508, 1.0403433685355425, 1.0343370382702424, 1.0260253629721263, 1.0190874745934839, 1.0162550296848161, 1.0111067394132647, 1.0075488617690114, 1.0054947921723159, 1.0025479530661834, 1.0038721800712695, 1.0072135339054396, 1.012331628438381, 1.0212388889049548, 1.0301083685213719, 1.0399495007461543, 1.051263721711498, 1.0657434894654818, 1.0822737269779785, 1.1002639410398871, 1.116582041706069, 1.1330041641718465, 1.148611290497124, 1.1651950222027039, 1.1810307148492252, 1.1972621049574057, 1.2136033775488229, 1.2295319291161055], [1.529637748928101, 1.5464036383752817, 1.5632439701053689, 1.5809842214487655, 1.5970476895954193, 1.6140190331587831, 1.6312817698123989, 1.6463983140538561, 1.6612693015959412, 1.6757233290849805, 1.6916678369921727, 1.7086130214768125, 1.725236783734025, 1.742100889449657, 1.7601978514704566, 1.7800205424809707, 1.7992297673259618, 1.8187976105804691, 1.8393963890359435, 1.8587251505318265, 1.878329486933507, 1.8955936182954951, 1.9117536517740432, 1.9259829188190749, 1.9391456282881354, 1.9504675305707173, 1.9603869804613108, 1.9699981039062495, 1.9777475910672107, 1.9849493605340667, 1.9890136492525956, 1.9930671294067479, 1.9980034707441294, 2.0005491889391962, 2.0038339311380948, 2.0065078349679384, 2.010043675641398, 2.0137755588812096, 2.0171606043184815, 2.0201905758540004, 2.0226617373960192, 2.0241920476381621, 2.0256620729458783, 2.0271662378706998, 2.028119378840664, 2.0294983778165063, 2.0313702885021758, 2.0328365389316421, 2.0335542474762636, 2.0339223412205274, 2.0338281083024139, 2.0324602418332569, 2.0304340553980942, 2.0275733047361095, 2.0239418348551803, 2.0199235491671299, 2.0152685362126412, 2.0088770928014772, 2.0021294570640356, 1.9936910368870069, 1.9841171367122279, 1.9752370784075997, 1.9680993981729868, 1.959803981274467, 1.9518677374017197, 1.9442399436226532, 1.9369613940758994, 1.9288935699620018, 1.9216697216520331, 1.9147173997904543, 1.9080176855229489, 1.9009520229852193, 1.8945284078869562, 1.8879327607687511, 1.8814162595814934, 1.8754157836969978, 1.8697257248751515, 1.8623642050430831, 1.8560661918537389, 1.8493663801169866, 1.8431815329729631, 1.8363595233306718, 1.8288592403447141, 1.8217294143919229, 1.8156552235564547, 1.808226760432021, 1.8000653866245704, 1.7926645628958122, 1.785518103737519, 1.7778724835582358, 1.7686219945666855, 1.7604713291218332, 1.7525712694644309, 1.7454860701721964, 1.7388216922063713, 1.7321645578763374, 1.7262124135055117, 1.7203515881826323, 1.7139613785364156, 1.7081340054681273, 1.7026523376258158, 1.6973094838604099, 1.6917084288517539, 1.6866083001150693, 1.6816638237794175, 1.6767656534006092, 1.6718940780970168, 1.6670605328783459, 1.6620853459815543, 1.6575545903646189, 1.6549997689450784, 1.6484004925172226, 1.6416350587352364, 1.6391477882950543, 1.6347781408022317, 1.6316214901802795, 1.6243512579746582, 1.6215605880363446, 1.620971457970291, 1.6171036361998787, 1.6145187361663251, 1.6125134289641361, 1.6091479441588985, 1.6076465428959608, 1.5998983131983264, 1.5981291254606702, 1.5949665039737677, 1.5910621366679163, 1.5890618089405977, 1.5855846033190328, 1.5802822505200949, 1.5721854340571155, 1.5619688448641695, 1.5514972238912232, 1.5405066549177833, 1.5301554463533757, 1.5208982395942598, 1.5151307253455042, 1.5089756334085522, 1.5056357138762138, 1.503007222791938, 1.5000513981099459, 1.4974485029608402, 1.4951794013086506, 1.4923229293907616, 1.4889417199441899, 1.4857207920047739, 1.4818184683783384, 1.4777129114834646, 1.4732690399748982]], [[1.5395579953745406, 0.94857302954023204, 0.94994622935422879, 0.95611451412591064, 0.96498826429845874, 0.97643781905557248, 0.99237558910500523, 1.0124991562338874, 1.0324583912878886, 1.0539828000429923, 1.0739835582901174, 1.0914423928295665, 1.107971861300173, 1.1219668833657626, 1.1340431419800892, 1.1473644130538134, 1.1606862179362087, 1.1728189286607325, 1.1850105751350117, 1.2000186869904736, 1.2180905345061128, 1.2406870389492157, 1.2602632131034444, 1.278441197977034, 1.2943549714305664, 1.3096822490539717, 1.32329303992619, 1.3366068912206213, 1.3504731130509051, 1.3670586682124051, 1.3826959730042574, 1.3990993465254422, 1.4152859693408746, 1.432530051604872, 1.4478813323649828, 1.4630741994734504, 1.4782988255772527, 1.492736677586435, 1.5074877220944773, 1.5217253275116696, 1.5356856168362822, 1.5504305793361188, 1.5576167976397479, 1.5649022831012249, 1.5735195242671427, 1.5809479630809065, 1.5882658576716002, 1.5954823939830654, 1.6024066493851876, 1.6091754008235857, 1.6156704653759992, 1.6225679261043202, 1.6349832125190393, 1.6433462035885273, 1.6500644841833061, 1.6599532957074756, 1.6686237581540253, 1.6753313219794186, 1.6818402336092162, 1.6885130325530233, 1.6959109234755587, 1.7028588980026309, 1.7088373862558326, 1.7142538159622778, 1.720920607762858, 1.7267980681532902, 1.7322616349610598, 1.7378016464321762, 1.7444576267879375, 1.7503293860479332, 1.7561053167433274, 1.7621309909383069, 1.7687504234296332, 1.7746197862018327, 1.7809081020681821, 1.7875418720959328, 1.7941693932475811, 1.8004878160645064, 1.8089420229544144, 1.8165754063473067, 1.8247967701065699, 1.8325121660286845, 1.8411564127533466, 1.8504609573478186, 1.8595932540968603, 1.8681323058251174, 1.8776959306769831, 1.8875279811583636, 1.8973513928818009, 1.9073740389219365, 1.9180354664693542, 1.9318275110726446, 1.9446286796291785, 1.9570234299423297, 1.9684726282894001, 1.9796484371783272, 1.9926504651434098, 2.0043014288729806, 2.0150954989136132, 2.027458233081445, 2.0393053689972227, 2.0491210778137789, 2.0581989361373596, 2.0690637392571798, 2.0787390388900686, 2.0879827152198649, 2.0970832342487395, 2.1064158604585241, 2.1158559841462408, 2.1258484792408527, 2.1362095784476365, 2.1473584007726174, 2.1571988425338393, 2.1669707845803421, 2.1783973687140898, 2.1924513563902739, 2.2054111035098569, 2.2156831606356526, 2.229476958864546, 2.2401708979522543, 2.2474564242613697, 2.2556665859495908, 2.2618723660918536, 2.2654801897194892, 2.2700785933423511, 2.2701502364108732, 2.2683838809752612, 2.2718505279702779, 2.2728442492574081, 2.2722649224890938, 2.2742676454758213, 2.2764521942473364, 2.2774458407907576, 2.2799291841760603, 2.2822052673724151, 2.2834259000761081, 2.2858484279507847, 2.2880798472231993, 2.2896243067541846, 2.2916537867360649, 2.2936924282502962, 2.2953287488976857, 2.2974056318165381, 2.2996617213979054, 2.301886328715939, 2.3041583287805221, 2.306902467160227, 2.3091569596506361, 2.3112750577067924, 2.3134546945493009, 2.3154189468348263], [1.5598828699165366, 1.5699225094453404, 1.5611201710448257, 1.5470834378811495, 1.5350013649973597, 1.5282083225747125, 1.5194294966341171, 1.5118101362702439, 1.5045358458967624, 1.4952771841181616, 1.4867820707515831, 1.4749675151835147, 1.4645275829952626, 1.4540594943102323, 1.4429821649452759, 1.433544810000807, 1.4242124569892745, 1.4172831110073842, 1.4121981898894858, 1.4067033140224563, 1.4028395652325172, 1.3989651202539555, 1.3956865078367537, 1.391837292738999, 1.3887008309588624, 1.385004496222455, 1.3808833480543985, 1.3770314960361438, 1.3719689217486406, 1.3645692374409235, 1.3560797356885592, 1.3469051815313855, 1.3372494537809578, 1.3265624651361037, 1.3169225588798863, 1.307019828305197, 1.2973841538941313, 1.2881009716830527, 1.2795034824251557, 1.2707693975233521, 1.2625990195737375, 1.2541501066302128, 1.2497513588430562, 1.2452144109949994, 1.23978921446477, 1.235065022626717, 1.2302176253878156, 1.2250442912786825, 1.2197407108104013, 1.214380572961691, 1.2089099857561192, 1.201238747976318, 1.1942156153034151, 1.1835825464653731, 1.1716099076345934, 1.1622946966744783, 1.1556555451938983, 1.1474539740423264, 1.137493227533759, 1.129861187941221, 1.1226729590473559, 1.1144491276949258, 1.1055970590313557, 1.098007258413783, 1.0897527573607735, 1.0820995375038209, 1.0740775293979254, 1.0659988384608208, 1.0562630492771798, 1.0474878113565511, 1.0388897126365242, 1.0303859657931467, 1.021205535840233, 1.0131285956475242, 1.0048897764715328, 0.99666434944778648, 0.9889540318975204, 0.98173327188729764, 0.97276189562039628, 0.96504051449280792, 0.95722309411807904, 0.95027530935073878, 0.94403071640117497, 0.93740283506377065, 0.93103069710749997, 0.92652508103725217, 0.92237729804807189, 0.91832192183427197, 0.91493332958635087, 0.91257056496038225, 0.91106908057421843, 0.90974668451273066, 0.90902793900118406, 0.90872377868002197, 0.90887291015883809, 0.90992057550090655, 0.91071801310164913, 0.91192131033080082, 0.91423719161589867, 0.91765547156480487, 0.9209976525958613, 0.92504777794715454, 0.92998851723175624, 0.93620296793747093, 0.94280102045891934, 0.95062650620839884, 0.9589681160162441, 0.96763641179572257, 0.97695611771233004, 0.98719442235346555, 0.99721986561939047, 1.0059188341886593, 1.0146824369478589, 1.0229623225821169, 1.0319361706048102, 1.0356864790077003, 1.0399481833557536, 1.0481896472000878, 1.0513183003627744, 1.0563215676271551, 1.0630826153771662, 1.0673848940726978, 1.0734687788682202, 1.0820676557469326, 1.0978498442155253, 1.1228006640893149, 1.1463775466767141, 1.1692173730715405, 1.1883303103406746, 1.2064785824008535, 1.2235209962703273, 1.2397471610596815, 1.2560167099369175, 1.2723275846507593, 1.287082060055019, 1.3014259760352971, 1.3164289327122043, 1.3306764760397587, 1.3444071924319239, 1.3577120837430761, 1.3711288482275679, 1.3849708150654763, 1.3997120395465856, 1.4130752331314498, 1.4272328859744063, 1.4412502304548289, 1.4560009771868716, 1.4700137583754813, 1.4847123396547031, 1.4998678352165931, 1.5149345077970524]], [[1.5716382248885317, 1.7074283751111301, 1.7208724292817248, 1.733253119745594, 1.7477914041924563, 1.7611757415712981, 1.7755093187499262, 1.790984196001536, 1.8046986872475199, 1.8180837214574628, 1.831177815928595, 1.8461652152654948, 1.8618436253890482, 1.8767971754019654, 1.8919120059794803, 1.9077782124730922, 1.9249038416884374, 1.9410113382499912, 1.9567977303976587, 1.972356573718641, 1.9863544190128293, 2.0035127431090576, 2.0194265219278376, 2.0342969754855194, 2.0479043661188623, 2.0611356358727693, 2.0734516121626836, 2.0863546016605001, 2.1000514494858793, 2.1142102861355099, 2.1261108948759588, 2.1374461210784181, 2.1482068106238312, 2.1595745786903451, 2.1685823179468073, 2.1764288179498648, 2.1831766987884591, 2.1894361526655159, 2.1952197873810926, 2.1998470669401708, 2.2046660004258158, 2.2086716861502764, 2.2097947746598714, 2.2120596033214941, 2.2142493099538556, 2.2163546122260804, 2.2185631768057483, 2.2213588725575519, 2.2242571308978496, 2.2264172746601152, 2.2276714919676253, 2.2287294143035736, 2.2318494486308467, 2.2307743446628692, 2.2306096897411818, 2.2327108472116968, 2.2342117813809219, 2.2335637196926017, 2.23174085374517, 2.2302321154853617, 2.2300605777720941, 2.2301829098411279, 2.2295126758914119, 2.2286615036226625, 2.2287362972546116, 2.2298272164987072, 2.2306378502366542, 2.2316937899999418, 2.2337124736289988, 2.2374370755406998, 2.2412436814172545, 2.2448244921593261, 2.2484661256946126, 2.252938814346686, 2.2572933154911166, 2.2614169109786504, 2.2648609640568313, 2.2675769601483582, 2.2694194558091842, 2.2707247532023929, 2.2711644415798395, 2.2709581635763976, 2.2702292434786027, 2.2689176710732188, 2.2662531521081792, 2.2622554202963667, 2.2582551559639947, 2.2538892592616921, 2.2492646754028285, 2.2442341455057058, 2.2391537677069548, 2.2346144165550808, 2.2296644005497841, 2.2246819061189274, 2.2198958477351995, 2.2151892363637704, 2.210776277480663, 2.2059322728589978, 2.2014185451679129, 2.1966504351607381, 2.1908289596306894, 2.1850271933002476, 2.1796875917933631, 2.1735122672760072, 2.165664648067573, 2.1585101859448619, 2.1500987545006258, 2.1410579982702238, 2.1321037670679415, 2.1227675152324759, 2.1108973669819591, 2.0958459585577396, 2.0798691004935046, 2.0656374116801768, 2.0517738824729546, 2.0383259916129499, 2.0249219678738832, 2.0128477225708794, 2.0012420451844823, 1.9877665332665535, 1.9727843648663601, 1.9541813132854917, 1.9338680840927363, 1.9117980784980446, 1.888656080887223, 1.8666271409425694, 1.8493579790478734, 1.8376863434874395, 1.8267486440441951, 1.8169818814344227, 1.8080077592739769, 1.7993669644107135, 1.7901424402911164, 1.780183527944267, 1.7698510409770645, 1.7600530465363529, 1.7501585722905768, 1.7393280954020562, 1.7289329803018327, 1.7184056605320146, 1.7072373797309071, 1.6950363226420417, 1.6805631478164751, 1.6629741703898588, 1.6456734552592216, 1.6266490754336844, 1.6095487780235025, 1.5936578864230138, 1.5804309837513766, 1.5671954639266192, 1.5547238179211122, 1.5432143721900902], [1.569559773745303, 1.0871180737391455, 1.0724939604913404, 1.0593045603760523, 1.0475944451174362, 1.036765628023067, 1.0243490626176568, 1.0128712578106365, 1.0030288604099553, 0.99342692191813675, 0.98418544699152177, 0.97527579286772115, 0.96723127116258611, 0.96060030916319261, 0.95565942268313087, 0.95188503948809799, 0.94969415332934171, 0.94949700953404359, 0.95094677492355162, 0.95421607334010239, 0.95882690072165366, 0.96598121811142224, 0.97628261701148999, 0.98719500154883533, 0.99622369322514481, 1.0054408804817605, 1.0159325309789069, 1.0265942426832222, 1.0390258896921516, 1.0538204578819144, 1.0669982097931738, 1.0809428480256877, 1.0958150155793112, 1.1126751610110972, 1.1278650332181197, 1.1435492814676063, 1.1594294406622487, 1.175034941111313, 1.1917334750881792, 1.2091861766847529, 1.2253232110638628, 1.238253725959118, 1.241879100913855, 1.2502359040609952, 1.2588874753009951, 1.2695458221720923, 1.2794672385654442, 1.2894696652988418, 1.2994692850931076, 1.3094945502245363, 1.3193479781607123, 1.3291145186672877, 1.340540359841043, 1.3554351350843652, 1.3695421486569443, 1.3829196220810307, 1.3966824164655616, 1.4075175853404909, 1.4185154112059679, 1.4311457117420352, 1.442134642762763, 1.4533217556670213, 1.4649401862479052, 1.4764671596408201, 1.4864750578378763, 1.4971884205658152, 1.5070018887882612, 1.5176776698433887, 1.5291293350889399, 1.5427272134128565, 1.5549501559749139, 1.5672449098297487, 1.5801021398443413, 1.59416425746102, 1.6068810009480554, 1.6201113954005109, 1.6334172223480397, 1.6456477500249185, 1.6564785114501237, 1.6698738397547113, 1.6805604019436577, 1.6918441688903396, 1.70212135674497, 1.7138293066807178, 1.7264928692065118, 1.7390763034091106, 1.7504896089481528, 1.763474149042108, 1.7764582908344071, 1.7884452714631371, 1.7994797004263519, 1.8102506914410508, 1.8230487933510566, 1.8343658441029733, 1.8457517769810736, 1.8577325664293858, 1.8711270305992398, 1.8871158109476043, 1.9016649266202466, 1.9150934826031334, 1.9304782448486266, 1.9452023861434931, 1.957931928864052, 1.9699545870331108, 1.9826248383810621, 1.992696358459269, 2.0008205494025293, 2.008015615858378, 2.0140776499585584, 2.0187077266552889, 2.0224755830822891, 2.0246809471385347, 2.0248817660869092, 2.0249182297365884, 2.0256442998980848, 2.0264666029675515, 2.0265286491947885, 2.02720232754805, 2.0281024763208064, 2.0292436258398414, 2.0300938092464511, 2.0322276288053267, 2.0339555503831157, 2.0335471940832242, 2.0303840509798601, 2.0260178121739063, 2.0173184872346299, 2.0081720736574677, 2.0001961152232184, 1.9926059513287164, 1.9831036101281958, 1.9725294595854741, 1.9628199722411854, 1.9534373694394818, 1.9428474176181141, 1.9328237680481213, 1.9233640538860417, 1.9139017894517394, 1.9052324707534909, 1.8969164750282477, 1.888967212325221, 1.8803348021442898, 1.8715490687322298, 1.8616445812915596, 1.8514057539639779, 1.8395119339815806, 1.8291824978538755, 1.8170081451457731, 1.8056581376306091, 1.7952772020770336, 1.7851677893146778, 1.7751160684009424]]], [2, 41]
#
#
# ss = parametrize_polyset(polyset, id_zero)
#
#
#
#
# for poly in polyset :
#     plt.plot(poly[0], poly[1])
#
# plt.show()
